makefile
# RA8M1 Target Configuration (Makefile equivalent of RA8M1.cmake)

# RA8M1 Specific Compiler Flags
RA8M1_ASM_FLAGS = -mcpu=cortex-m85
RA8M1_C_FLAGS = -mcpu=cortex-m85
RA8M1_CXX_FLAGS = -mcpu=cortex-m85
RA8M1_LINKER_FLAGS = -mcpu=cortex-m85

# Linker Script Selection (based on compiler)
ifeq ($(CC),*gcc*)
    RA8M1_LINKER_FLAGS += -Tfsp.ld --specs=nano.specs
else ifeq ($(CC),*clang*)
    RA8M1_LINKER_FLAGS += -Tfsp.lld
endif

# RA8M1 Definitions
RA8M1_DEFINES = -DRA8M1 -D_RA_CORE=CM85 -D_RA_ORDINAL=1 -D_RENESAS_RA_

# HAL Library Sources (equivalent to file(GLOB_RECURSE HAL_Files...))
RA8M1_HAL_SOURCES = $(shell find RA8M1/ra -name "*.c" -o -name "*.cpp" 2>/dev/null) \
                    $(shell find RA8M1/ra_gen -name "*.c" -o -name "*.cpp" 2>/dev/null) \
                    $(shell find RA8M1/lib -name "*.c" 2>/dev/null)

# Additional Definitions for HAL Library
HAL_DEFINES = -DSEGGER_RTT_MODE_DEFAULT=SEGGER_RTT_MODE_BLOCK_IF_FIFO_FULL

# RA8M1 Include Directories
RA8M1_INCLUDES = -IRA8M1/ra/arm/CMSIS_5/CMSIS/Core/Include \
                 -IRA8M1/ra/fsp/inc \
                 -IRA8M1/ra/fsp/inc/api \
                 -IRA8M1/ra/fsp/inc/instances \
                 -IRA8M1/ra_cfg/fsp_cfg \
                 -IRA8M1/ra_cfg/fsp_cfg/bsp \
                 -IRA8M1/ra_gen \
                 -IRA8M1/lib/SEGGER_RTT

# RA8M1 Library Directories
RA8M1_LIB_DIRS = -LRA8M1/script

# Object files for RA8M1 HAL sources
RA8M1_HAL_OBJS = $(patsubst %.c,%.c.o,$(filter %.c,$(RA8M1_HAL_SOURCES))) \
                 $(patsubst %.cpp,%.cpp.o,$(filter %.cpp,$(RA8M1_HAL_SOURCES)))

# Add RA8M1 configuration to HAL library build
libhal.a: $(RA8M1_HAL_OBJS)
	@echo "  AR      $@"
	$(Q)$(AR) rcs $@ $(filter %.o,$^)

# Compilation rules with RA8M1 flags
%.c.o: %.c
	@echo "  CC      $@"
	$(Q)[ -d $(@D) ] || mkdir -p $(@D)
	$(Q)$(CC) -c -o $@ $(CFLAGS) $(RA8M1_C_FLAGS) $(RA8M1_DEFINES) $(HAL_DEFINES) $(RA8M1_INCLUDES) $<

%.cpp.o: %.cpp
	@echo "  CXX     $@"
	$(Q)[ -d $(@D) ] || mkdir -p $(@D)
	$(Q)$(CXX) -c -o $@ $(CXXFLAGS) $(RA8M1_CXX_FLAGS) $(RA8M1_DEFINES) $(HAL_DEFINES) $(RA8M1_INCLUDES) $<

%.S.o: %.S
	@echo "  AS      $@"
	$(Q)[ -d $(@D) ] || mkdir -p $(@D)
	$(Q)$(CC) -c -o $@ $(CFLAGS) $(RA8M1_ASM_FLAGS) $(RA8M1_DEFINES) $(HAL_DEFINES) $(RA8M1_INCLUDES) $<

# Linker flags for final executables
LDFLAGS += $(RA8M1_LINKER_FLAGS) $(RA8M1_LIB_DIRS)